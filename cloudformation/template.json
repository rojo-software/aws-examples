{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Description": "AWS example code, REST API on Dynamo",
  "Resources": {
    "ProcessorLambdaStack": {
      "Type": "AWS::CloudFormation::Stack",
      "Properties": {
        "TemplateURL": {
          "Fn::Join": [
            "/",
            [
              "https://s3.amazonaws.com/",
              "${DeploymentBucket}",
              "templates/lambda.template.json"
            ]
          ],
          "Parameters": {
            "ApiId": "${ApiId}",
            "AppName": "${AppName}",
            "DeploymentBucket": "${DeploymentBucket}",
            "DynamoTableName": "${DynamoTableName}",
            "FunctionType": "processor",
            "StageName": "${DeploymentName}"
          }
        }
      }
    }
  },
  "Parameters": {
    "ApiId": {
      "Type": "String",
      "Default": "a3jp3ewyog"
    },
    "AppName": {
      "Type": "String",
      "Default": "aws-example"
    },
    "DynamoTableName": {
      "Type": "String",
      "Default": "example"
    },
    "DeploymentBucket": {
      "Type": "String",
      "Default": "s3://rojo-software-deployment/aws-example/",
      "Description": "S3 bucket for deployment artifacts"
    },
    "DeploymentName": {
      "Type": "String",
      "Default": "dev",
      "Description": "Deployment name"
    }
  }
}

